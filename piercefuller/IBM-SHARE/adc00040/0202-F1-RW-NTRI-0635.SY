      SUBROUTINE NTRI   (A,B,N)                                         NTRI0001
      DIMENSION A(50,50),B(50)                                          NTRI0002
      NN=N-2                                                            NTRI0003
      DO 15J=1,NN                                                       NTRI0004
      II=J+2                                                            NTRI0005
      DO 15I=II,N                                                       NTRI0006
      IF (A(I,J))9,15,9                                                 NTRI0007
 9    IF (ABSF(A(J+1,J))-ABSF(A(I,J)))11,10,10                          NTRI0008
 10   R=A(I,J)/A(J+1,J)                                                 NTRI0009
      GO TO 13                                                          NTRI0010
 11   R=A(J+1,J)/A(I,J)                                                 NTRI0011
      DO 32K=1,N                                                        NTRI0012
      C=A(J+1,K)                                                        NTRI0013
      A(J+1,K)=A(I,K)                                                   NTRI0014
 32   A(I,K)=C                                                          NTRI0015
      DO 12K=1,N                                                        NTRI0016
      C=A(K,I)                                                          NTRI0017
      A(K,I)=A(K,J+1)                                                   NTRI0018
 12   A(K,J+1)=C                                                        NTRI0019
 13   JJ=J+1                                                            NTRI0020
      DO 14K=JJ,N                                                       NTRI0021
 14   A(I,K)=A(I,K)-R*A(J+1,K)                                          NTRI0022
      DO 16K=1,N                                                        NTRI0023
 16   A(K,J+1)=A(K,J+1)+R*A(K,I)                                        NTRI0024
 15   CONTINUE                                                          NTRI0025
      RETURN                                                            NTRI0026
      END(2,2,2,2,2)                                                    NTRI0027
