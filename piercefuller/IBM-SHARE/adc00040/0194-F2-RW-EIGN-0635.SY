      SUBROUTINE EIGN  (N,A,B,C,NI)                                     EIGN0001
      COMMON  N,A,B,C                                                   EIGN0002
      DIMENSION A(50,50),B(50),C(50)                                    EIGN0003
      CALL NTRI (A,B,N)                                                 EIGN0004
      CALL GRT (N,C,NI)                                                 EIGN0005
      RETURN                                                            EIGN0006
      END(2,2,2,2,2)                                                    EIGN0007
      SUBROUTINE AUX(ALPHA,DETN)                                        EIGN0008
      DIMENSION A(50,50),B(50)                                          EIGN0009
      COMMON  N,A,B,C                                                   EIGN0010
      DETN=1.                                                           EIGN0011
      DO 172J=1,N                                                       EIGN0012
 172  B(J)=A(1,J)                                                       EIGN0013
      B(1)=B(1)-ALPHA                                                   EIGN0014
      DO 177I=2,N                                                       EIGN0015
      J=I+1                                                             EIGN0016
      IF(ABSF(B(I-1))-ABSF(A(I,I-1)))175,169,169                        EIGN0017
 169  IF (B(I-1))173,179,173                                            EIGN0018
 173  R=A(I,I-1)/B(I-1)                                                 EIGN0019
      B(I)= A(I,I)-ALPHA - R*B(I)                                       EIGN0020
      DO 174K=J,N                                                       EIGN0021
 174  B(K)=A(I,K)- R*B(K)                                               EIGN0022
      GO TO 177                                                         EIGN0023
 175  R=B(I-1)/A(I,I-1)                                                 EIGN0024
      B(I-1)=A(I,I-1)                                                   EIGN0025
      B(I)=B(I)- R*(A(I,I)-ALPHA)                                       EIGN0026
      DO 176K=J,N                                                       EIGN0027
 176  B(K)=B(K)- R*A(I,K)                                               EIGN0028
      DETN=-DETN                                                        EIGN0029
 177  CONTINUE                                                          EIGN0030
      DO 178I=1,N                                                       EIGN0031
 178  DETN=DETN*B(I)                                                    EIGN0032
 171  RETURN                                                            EIGN0033
 179  DETN=0.                                                           EIGN0034
      GO TO 171                                                         EIGN0035
      END (2,2,2,2,2)                                                   EIGN0036
      SUBROUTINE NTRI   (A,B,N)                                         EIGN0037
      DIMENSION A(50,50),B(50)                                          EIGN0038
      NN=N-2                                                            EIGN0039
      DO 15J=1,NN                                                       EIGN0040
      II=J+2                                                            EIGN0041
      DO 15I=II,N                                                       EIGN0042
      IF (A(I,J))9,15,9                                                 EIGN0043
 9    IF (ABSF(A(J+1,J))-ABSF(A(I,J)))11,10,10                          EIGN0044
 10   R=A(I,J)/A(J+1,J)                                                 EIGN0045
      GO TO 13                                                          EIGN0046
 11   R=A(J+1,J)/A(I,J)                                                 EIGN0047
      DO 32K=1,N                                                        EIGN0048
      C=A(J+1,K)                                                        EIGN0049
      A(J+1,K)=A(I,K)                                                   EIGN0050
 32   A(I,K)=C                                                          EIGN0051
      DO 12K=1,N                                                        EIGN0052
      C=A(K,I)                                                          EIGN0053
      A(K,I)=A(K,J+1)                                                   EIGN0054
 12   A(K,J+1)=C                                                        EIGN0055
 13   JJ=J+1                                                            EIGN0056
      DO 14K=JJ,N                                                       EIGN0057
 14   A(I,K)=A(I,K)-R*A(J+1,K)                                          EIGN0058
      DO 16K=1,N                                                        EIGN0059
 16   A(K,J+1)=A(K,J+1)+R*A(K,I)                                        EIGN0060
 15   CONTINUE                                                          EIGN0061
      RETURN                                                            EIGN0062
      END(2,2,2,2,2)                                                    EIGN0063
      SUBROUTINE GRT  (N,C,IN)                                          EIGN0064
      DIMENSION C(50)                                                   EIGN0065
      DO 100 L=1,N                                                      EIGN0066
      JK=0                                                              EIGN0067
      IF (C(L))45,46,45                                                 EIGN0068
 45   RT=.9*C(L)                                                        EIGN0069
      ASSIGN 1 TO NN                                                    EIGN0070
      GO TO 80                                                          EIGN0071
 1    X0=FPRT                                                           EIGN0072
      RT=1.1*C(L)                                                       EIGN0073
      ASSIGN 2 TO NN                                                    EIGN0074
      GO TO 80                                                          EIGN0075
 2    X1=FPRT                                                           EIGN0076
      RT=C(L)                                                           EIGN0077
      ASSIGN 3 TO NN                                                    EIGN0078
      GO TO 80                                                          EIGN0079
 3    X2=FPRT                                                           EIGN0080
      GO TO 50                                                          EIGN0081
 46   RT=-1.                                                            EIGN0082
      ASSIGN 4 TO NN                                                    EIGN0083
      GO TO 80                                                          EIGN0084
 4    X0=FPRT                                                           EIGN0085
      RT=1.                                                             EIGN0086
      ASSIGN 5 TO NN                                                    EIGN0087
      GO TO 80                                                          EIGN0088
 5    X1=FPRT                                                           EIGN0089
      RT=0.                                                             EIGN0090
      ASSIGN 6 TO NN                                                    EIGN0091
      GO TO 80                                                          EIGN0092
 6    X2=FPRT                                                           EIGN0093
 50   H=-1.                                                             EIGN0094
      D=-.5                                                             EIGN0095
 49   DD=1.+D                                                           EIGN0096
      BI=(X0*D*D)-(X1*DD*DD)+(X2*(DD+D))                                EIGN0097
      DEN=BI*BI-(4.*X2*D*DD)(X0*D-(X1*DD)+X2)                           EIGN0098
      IF (DEN)52,52,51                                                  EIGN0099
 52   IF (IN)36,35,36                                                   EIGN0100
 35   WRITE OUTPUT TAPE 6,25,L,DEN                                      EIGN0101
 36   DEN=0.                                                            EIGN0102
 51   DEN=SQRTF(DEN)                                                    EIGN0103
 53   DN=BI+DEN                                                         EIGN0104
      DM=BI-DEN                                                         EIGN0105
      IF (ABSF(DN)-ABSF(DM))57,57,56                                    EIGN0106
 56   DEN=DN                                                            EIGN0107
      GO TO 58                                                          EIGN0108
 57   DEN=DM                                                            EIGN0109
 58   IF (DEN)55,54,55                                                  EIGN0110
 54   DEN=1.                                                            EIGN0111
 55   DI=(-2.*X2*DD)/DEN                                                EIGN0112
      H=DI*H                                                            EIGN0113
      RT=RT+H                                                           EIGN0114
      IF (ABSF(H/RT)-1.0E-6)75,75,60                                    EIGN0115
 60   ASSIGN 7 TO NN                                                    EIGN0116
      GO TO 80                                                          EIGN0117
 7    IF (ABSF(FPRT)-ABSF(X2*10.))62,61,61                              EIGN0118
 61   DI=DI*.5                                                          EIGN0119
      H=H*.5                                                            EIGN0120
      RT=RT-H                                                           EIGN0121
      GO TO 80                                                          EIGN0122
 62   X0=X1                                                             EIGN0123
      X1=X2                                                             EIGN0124
      X2=FPRT                                                           EIGN0125
      D=DI                                                              EIGN0126
      GO TO 49                                                          EIGN0127
 75   CALL AUX (RT,FRT)                                                 EIGN0128
 76   C(L)=RT                                                           EIGN0129
      IF (IN)100,77,100                                                 EIGN0130
 77   WRITE OUTPUT TAPE 6,26,L,RT,FRT                                   EIGN0131
 26   FORMAT (I3,2E20.8/1H )                                            EIGN0132
 100  CONTINUE                                                          EIGN0133
 27   FORMAT (//)                                                       EIGN0134
      IF (IN)33,34,33                                                   EIGN0135
 34   WRITE OUTPUT TAPE 6,28                                            EIGN0136
 33   RETURN                                                            EIGN0137
 80   JK=JK+1                                                           EIGN0138
      IF (100-JK)75,75,86                                               EIGN0139
 86   CALL AUX (RT,FRT)                                                 EIGN0140
      FPRT=FRT                                                          EIGN0141
      IF (L-1)81,91,81                                                  EIGN0142
 81   DO 82 I=2,L                                                       EIGN0143
      TEM=RT-C(I-1)                                                     EIGN0144
      IF (ABSF(TEM)-1.0E-20)85,82,82                                    EIGN0145
 82   FPRT=FPRT/TEM                                                     EIGN0146
 91   IF (IN) 89,83,89                                                  EIGN0147
 83   WRITE OUTPUT TAPE 6,25,L,RT,FRT,FPRT                              EIGN0148
 89   IF (ABSF(FRT)-1.0E-20)90,84,84                                    EIGN0149
 90   IF (ABSF (FPRT)-1.0E-20)76,84,84                                  EIGN0150
 84   GO TO NN,(1,2,3,4,5,6,7)                                          EIGN0151
 85   RT=RT+.001                                                        EIGN0152
      IF (IN) 88,87,88                                                  EIGN0153
 87   WRITE OUTPUT TAPE 6,25,L                                          EIGN0154
 88   GO TO 80                                                          EIGN0155
 28   FORMAT (1H1)                                                      EIGN0156
 25   FORMAT (I3,3E20.8)                                                EIGN0157
      END (2,2,2,2,2)                                                   EIGN0158
