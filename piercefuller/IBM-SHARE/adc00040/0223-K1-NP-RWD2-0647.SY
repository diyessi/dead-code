NPRWD2 REM 0069 03169                                                   RWD20001
       REM    RWDM, READ WRITE DRUM MODULO SUB-ROUTINE                  RWD20002
       REM    CALLING SEQUENCE,                                         RWD20003
       REM                   A   = TSX  RWDM,4                          RWD20004
       REM                   A+1 = (*)  0,0,N                           RWD20005
       REM                   A+2 = PZE  I,0,OD                          RWD20006
       REM                   A+3 = PZE  J,0,OC                          RWD20007
       REM                   A+4 = NORMAL RETURN                        RWD20008
       REM     (*), PZE OR MZE.  PZE FOR READ,  MZE FOR WRITE           RWD20009
       REM     N, NUMBER OF LOCATIONS TRANSFERED.                       RWD20010
       REM     I, INTERVAL BETWEEN SELECTED DRUM LOCATIONS              RWD20011
       REM     OD, ABSTRACT DRUM ORIGIN FOR FIRST WORD                  RWD20012
       REM     J, INTERVAL BETWEEN SELECTED CORE LOCATIONS              RWD20013
       REM     OC, CORE ORIGIN OF FIRST WORD                            RWD20014
       ORG 0                                                            RWD20015
 RWDM  SXD R1-1,1                                                       RWD20016
       SXD R4-1,2                  SAVE IR NO. 1 AND 2                  RWD20017
       CLA 1,4                                                          RWD20018
       TMI R1                                                           RWD20019
       CLA R10                     SET READ DRUM                        RWD20020
       TXL R2,0,*                  * SAVE IR 1                          RWD20021
 R1    CLA R11                     SET WRITE DRUM                       RWD20022
 R2    STO R6                      CPY LOOP  DRUM SELECT                RWD20023
       STO R3                      INITIAL  DRUM SELECT                 RWD20024
       CAL 1,4                                                          RWD20025
       PDX 0,1                     N TO IR 1                            RWD20026
       CAL 2,4                                                          RWD20027
       STA R14                     DRUM LOCATION  INTERVAL              RWD20028
       ARS 18                                                           RWD20029
       ADD R12                     DEVELOPMENT OF LOCICAL DRUM NO AND   RWD20030
       STO R15                     DRUM LOCATION FROM ABSTRACT          RWD20031
       ADD R14                     DRUM LOCATION AND SPECIAL            RWD20032
       ARS 11                      WORD.                                RWD20033
       STA R6                                                           RWD20034
       CLA R15                                                          RWD20035
       ARS 11                                                           RWD20036
       STA R3                                                           RWD20037
 R3    HTR *                       READ, WRITE SELECT DRUM WORD         RWD20038
       CLA 3,4                                                          RWD20039
       PAX 0,2                                                          RWD20040
       SXD R7,2                                                         RWD20041
       ARS 18                                                           RWD20042
       ADD R13                                                          RWD20043
       STA R5+1                    CORE ORIGIN TO CPY ADDR.             RWD20044
       LXD R9,2                    -1 TO IR2                            RWD20045
       TXL R5,0,*                  * SAVE IR 2 , SKIP TO FIRST CPY      RWD20046
 R4    CLA R15                     MANUFACTURES DRUM ADDRESS AND        RWD20047
       ADD R14                     LOGICAL DRUM NO.                     RWD20048
       STO R15                     FOR EACH SUCCESSIVE                  RWD20049
       ADD R14                     LOCATION CALLED FROM                 RWD20050
       ARS 11                      DRUM                                 RWD20051
       STA R6                                                           RWD20052
 R5    LDA R15                                                          RWD20053
       CPY *,2                                                          RWD20054
 R6    HTR *                       READ, WRITE SELECT, MANUFACTURED     RWD20055
 R7    TIX R8,2,*                  CORE LOCATION MODIFICATION           RWD20056
 R8    TIX R4,1,1                  COUNTS N TRANSFERED ITEMS            RWD20057
       LDA R15                     DISCONNECT DRUM                      RWD20058
       LXD R1-1,1                                                       RWD20059
       LXD R4-1,2                  RESTORE IR 1 AND 2                   RWD20060
       TRA 4,4                     EXIT SUB-ROUTINE                     RWD20061
 R9    PZE 0,0,-1                                                       RWD20062
 R10   RDS *                                                            RWD20063
 R11   WRS *                                                            RWD20064
 R12   OCT 1404000                                                      RWD20065
 R13   OCT -1                                                           RWD20066
 R14   PZE 0                       WORKING STORAGE FOR DRUM ADDR.       RWD20067
 R15   PZE 0                       WORKING STORAGE                      RWD20068
 OR    END RWDM                                                         RWD20069
