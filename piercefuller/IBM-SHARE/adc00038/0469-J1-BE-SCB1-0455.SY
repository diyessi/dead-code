       REM BE SCB 1 - ABSOLUTE BINARY CARD PUNCH - G. H. MEALY -94 CARBESCB10001
       REM                                                            BESCB10002
       FUL                                                            BESCB10003
 0         VR+1,,32           CONTROL CARD FOR LOADING WITH FORTRAN   BESCB10004
           -26-COMMON           OBJECT PROGRAM LOADER                 BESCB10005
       REL                                                            BESCB10006
COMMON SYN 1024                                                       BESCB10007
       ORG 0                                                          BESCB10008
BESCB1 CLA 1,4                                                        BESCB10009
       TMI *+3                                                        BESCB10010
       CLS SW                 SET SWITCH AND WRS FOR ROW BINARY       BESCB10011
       STO SW                                                         BESCB10012
       CAL 1,4                                (CALLING SEQUENCE =     BESCB10013
       STD X4                 1,,B     IN XR4 (   TSX BESCB1,4  )     BESCB10014
       ARS 18                                 (   XZE A,,B        )   BESCB10015
       ADD X4                 B+1,,B   IN AC  (   PZE L         )     BESCB10016
       STA MOVE                                                       BESCB10017
       SBM 1,4                B+A-1   IN AC                           BESCB10018
       TMI 3,4                EXIT IF B LESS THAN A                   BESCB10019
       SXD X4,4               SAVE INDEX REGISTERS                    BESCB10020
       SXD X2,2                                                       BESCB10021
       SXD X1,1                                                       BESCB10022
 Q22   PAX 22,1               TOTAL WORD COUNT TO XR1                 BESCB10023
       CLA 2,4                STORE LOADING ORIGIN                    BESCB10024
 NEXT  STA VR                                                         BESCB10025
 Q24   PXD 24,,                                                       BESCB10026
       LXA Q22,6                                                      BESCB10027
       STZ 13L,2                                                      BESCB10028
       TIX *-1,2,1                                                    BESCB10029
 MOVE  CLA **,1               MOVE WORDS INTO CARD IMAGE              BESCB10030
       STO 13L,4                                                      BESCB10031
       TNX *+3,4,1                                                    BESCB10032
       TNX *+2,1,1            IF BLOCK ENDED                          BESCB10033
       TXI *-4,2,1                                                    BESCB10034
       SXD VR,2               PUT IMAGE WORD COUNT IN VR              BESCB10035
       CLA VR                 INSERT COLUMN BINARY CONTROL PUNCHES    BESCB10036
       STO 9L                                                         BESCB10037
       LXA Q22,2              COMPUTE CHECKSUM                        BESCB10038
       CAL 9L                                                         BESCB10039
       ACL 13L,2                                                      BESCB10040
       TIX *-1,2,1                                                    BESCB10041
       SLW 9R                                                         BESCB10042
       LXA Q24,4                                                      BESCB10043
 X1    SYN *                                                          BESCB10044
 SW    TXH ROW,,**            TXH IF COLUMN - TXL IF ROW              BESCB10045
       WPU                                                            BESCB10046
       CLA 79BIT                                                      BESCB10047
       ORS 9L                                                         BESCB10048
       ACL 9R                                                         BESCB10049
       SLW 9R                                                         BESCB10050
       LXD Q12,2              ROW COUNT                               BESCB10051
 LP2   STZ NR                 ROW LOOP                                BESCB10052
       LXA Q24,4                                                      BESCB10053
 LP1   CAL 13L,4              WORD LOOP                               BESCB10054
       LRS 13,2                 PICK UP IMAGE WORD AND PUT 3 BITS     BESCB10055
       ARS 11                   IN ROW WORD                           BESCB10056
       LRS 1                                                          BESCB10057
       ARS 11                                                         BESCB10058
       LRS 1                                                          BESCB10059
       CAL NR                                                         BESCB10060
       LLS 3                                                          BESCB10061
       SLW NR                                                         BESCB10062
       TXH *+4,4,13           IF LEFT ROW NOT DONE                    BESCB10063
 Q12   TXL *+3,4,12           IF RIGHT ROW                            BESCB10064
       SLW NL                 LEFT ROW DONE                           BESCB10065
       STZ NR                                                         BESCB10066
       TIX LP1,4,1            GO BACK FOR NEXT IMAGE WORD             BESCB10067
       CPY NL                 COPY ROW                                BESCB10068
       CPY NR                                                         BESCB10069
       TIX LP2,2,1            GO BACK FOR NEXT ROW                    BESCB10070
 FIX   CLA VR                 COMPUTE LOADING ORIGIN FOR NEXT CARD    BESCB10071
       ARS 18                                                         BESCB10072
       ADD VR                                                         BESCB10073
       TIX NEXT,1,1           GO BACK FOR NEXT CARD IF BLOCK NOT DONE BESCB10074
       CAL SW                 RESET ROW-COLUMN SWITCH                 BESCB10075
       STO SW                                                         BESCB10076
       LXD X1,1               RESTORE INDEX REGISTERS AND EXIT        BESCB10077
       LXD X2,2                                                       BESCB10078
       LXD X4,4                                                       BESCB10079
       TRA 3,4                                                        BESCB10080
 ROW   WPU                    ROW BINARY (OR TAPE) COPY LOOP          BESCB10081
       CPY 13L,4                                                      BESCB10082
       TIX *-1,4,1                                                    BESCB10083
 X2    TXL FIX,,**                                                    BESCB10084
 X4        1,,**                                                      BESCB10085
 79BIT     ,,320              COLUMN BINARY CONTROL BITS              BESCB10086
 VR        **,,**                                                     BESCB10087
       ORG COMMON                                                     BESCB10088
 9L    BSS 1                                                          BESCB10089
 9R    BSS 1                                                          BESCB10090
 13L   BES 22                                                         BESCB10091
 NL    BSS 1                                                          BESCB10092
 NR    BSS 1                                                          BESCB10093
       END BESCB1                                                     BESCB10094
