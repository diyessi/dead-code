       REM BE TCB 1 - BINARY TAPE-TO-CARD SIMULATOR, G.H.MEALY, 74CARDBETCB10001
       REM                                                            BETCB10002
       ORG 24                                                         BETCB10003
BETCB1 REW TAPE                                                       BETCB10004
 READ  LXD QMAX,2             RECORD COUNT WITHIN BLOCK               BETCB10005
 REC   LXA *+2,4              RETRIAL COUNT FOR RTT                   BETCB10006
       RTT                                                            BETCB10007
       NOP 6                                                          BETCB10008
 RTB   RTB TAPE                                                       BETCB10009
       LXD Q24,1              RECORD WORD COUNT                       BETCB10010
       CPY BLOCK,3                                                    BETCB10011
       TXI *+3,1,-1                                                   BETCB10012
 QMAX  TXI EOF,,24*32         END OF FILE                             BETCB10013
       HTR RER                FALSE END OF RECORD                     BETCB10014
 CPY   CPY BLOCK,3                                                    BETCB10015
       TXI TIX                                                        BETCB10016
       HTR RER                FALSE END OF FILE                       BETCB10017
       STZ BLOCK,3                                                    BETCB10018
       TIX *-1,1,1                                                    BETCB10019
 EOR   IOD                                                            BETCB10020
       ARS 255                                                        BETCB10021
       RTT                                                            BETCB10022
       TRA RER                TAPE CHECK                              BETCB10023
       CLA BLOCK-24,2                                                 BETCB10024
       PDX ,4                                                         BETCB10025
       CLA 79BIT              INSERT CONTROL BITS                     BETCB10026
       ORS BLOCK-24,2                                                 BETCB10027
       TXL *+4,4,0            IF CORRECTION/TRANSFER CARD             BETCB10028
       TXH *+3,4,22           IF ORIGIN OR OTHER FUL CARD             BETCB10029
       ACL BLOCK-23,2         ADJUST CHECKSUM                         BETCB10030
       SLW BLOCK-23,2                                                 BETCB10031
       TIX REC,2,32           NEXT RECORD                             BETCB10032
       TXI WRITE,2,-32                                                BETCB10033
 TIX   TIX CPY,1,1            NEXT WORD                               BETCB10034
 Q24   TXI EOR,,24                                                    BETCB10035
 RER   BST TAPE               BACKSPACE AND RETRY SIX TIMES           BETCB10036
       TIX REC+1,4,1                                                  BETCB10037
       HTR REC                SIXTH TAPE CHECK                        BETCB10038
 WRITE SXD TST,2              STORE RECORD COUNT                      BETCB10039
       LXD QMAX,1                                                     BETCB10040
 NEXT  WPU                    COLUMN BINARY PUNCH LOOP                BETCB10041
       LXD Q12,2                                                      BETCB10042
 LOOP  LXD Q24,4                                                      BETCB10043
       CAL BLOCK,5                                                    BETCB10044
       LRS 13,2                                                       BETCB10045
       ARS 11                                                         BETCB10046
       LRS 1                                                          BETCB10047
       REP 2,1                                                        BETCB10048
       CAL NR                                                         BETCB10049
       LLS 3                                                          BETCB10050
       SLW NR                                                         BETCB10051
       TXH *+3,4,13           IF LEFT ROW UNFINISHED                  BETCB10052
 Q12   TXL *+2,4,12           IF RIGHT ROW                            BETCB10053
       SLW NL                                                         BETCB10054
       TIX LOOP+1,4,1         NEXT WORD                               BETCB10055
       CPY NL                 ROW DONE - COPY IT                      BETCB10056
       CPY NR                                                         BETCB10057
       TIX LOOP,2,1                                                   BETCB10058
       TXI *+1,1,-32                                                  BETCB10059
 TST   TXH NEXT,1,**                                                  BETCB10060
 SW    TXL READ               TXH IF LAST BLOCK IN FILE               BETCB10061
       TRA *+4                                                        BETCB10062
 EOF   CAL SW                                                         BETCB10063
       STO SW                                                         BETCB10064
       TXL WRITE,2,23*32      STORE RECORD COUNT AND PUNCH BLOCK      BETCB10065
       WPU                    EJECT TWO BLANK CARDS                   BETCB10066
       WPU                                                            BETCB10067
       HTR READ               END OF FILE STOP                        BETCB10068
 NR                                                                   BETCB10069
 NL                                                                   BETCB10070
79BIT  PZE ,,320              COLUMN BINARY CONTROL BITS              BETCB10071
 BLOCK BES 25*32              BUFFER STORAGE                          BETCB10072
 TAPE  EQU 4                                                          BETCB10073
       END BETCB1                                                     BETCB10074
