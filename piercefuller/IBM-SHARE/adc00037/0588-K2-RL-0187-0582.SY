       REM RL0187  SCP CORE CONSOLIDATION ROUTINE                       01870001
L187   SXD L187+0153,4            SAVE FOR RETURN                       01870002
       STZ L187+0155         PRESET                                     01870003
       CLA L187+0156         PRESET                                     01870004
       STO L187+0092                                                    01870005
       CLA L187+0027         PRESET                                     01870006
       ADD L183+73                                                      01870007
       STA L187+0045                                                    01870008
       PXD                                                              01870009
       STA L187+0125         PRESET ADDRESS TO ZERO                     01870010
       LXA L184+1,4                                                     01870011
       CLA 0,4               TEST IF CONSOLIDATION NECESSARY            01870012
       TMI L187+0014                                                    01870013
       LXD L187+0153,4                                                  01870014
       TRA 1,4               RETURN TO EXEC ROUTING                     01870015
       LXD L184,2                                                       01870016
       CLA L184+1                                                       01870017
       STD L187+0017                                                    01870018
       TXH L187+0021,2,*            EXIT IF CONSOL NECESSARY            01870019
       CLA L184                                                         01870020
       LXA L184,2                                                       01870021
       TRA L187+0143                                                    01870022
       CLS 1,4               FLAG ALL HOLES BY PUTTING                  01870023
       STO 1,4                MINUS SIGNS ON SECOND CONTROL             01870024
       LDQ 0,4                WORD                                      01870025
       TQP L187+0027                                                    01870026
       PAX 0,4                                                          01870027
       TRA L187+0021                                                    01870028
       CLA L184              CHANGE ADDRESS PORTION OF FIRST            01870029
       PDX 0,1                CONTROL WORD OF ALL NON HOLE              01870030
       PAX 0,2                TABLE ENTRIES.                            01870031
       TXI L187+0031,1,2            INCREASE WORD COUNT BY TWO          01870032
       CAL 0,2                                                          01870033
       ADD L183+75           ADD TWO IN DECR                            01870034
       STD L187+0043                                                    01870035
       STD L187+0044                                                    01870036
       LDQ 1,2                                                          01870037
       TQP L187+0041                                                    01870038
       ARS 18                THIS IS A HOLE                             01870039
       ADD L187+0155                                                    01870040
       STO L187+0155                                                    01870041
       TRA L187+0043                                                    01870042
       ADD L187+0155         THIS IS NOT A HOLE                         01870043
       STA 0,2               DIMINISH ADDRESS BY SHIFT                  01870044
       TIX L187+0044,2,*            DECR CONTAINS WC+2. SET BY N4.      01870045
       TIX L187+0031,1,*            DECR CONTAINS WC+2. SET BY N4.      01870046
       CLA L184+2            CHANGE CONTROL WORDS ON ALL                01870047
       TPL L187+0052          TABLE ENTRIES.                            01870048
       TZE L187+0093         END OF ALPHA TABLE                         01870049
       PAX 0,1                                                          01870050
       CLA L187+0157                                                    01870051
       STO L187+0092                                                    01870052
       TXI L187+0053,0,*           USE DECR TO SAVE IR1                 01870053
       PAX 0,1                                                          01870054
       CLA L187+0045         PRESET ADDRESSES FOR NEXT                  01870055
       STA L187+0091          ALPHA ENTRY                               01870056
       ADD L183+72           ADD ONE                                    01870057
       STA L187+0045                                                    01870058
       TNX L187+0045,1,0            EXIT IF ALPHA ENTRY ZERO            01870059
       SXD L187+0051,1                                                  01870060
       CLA 1,1                                                          01870061
       PDX 0,2                                                          01870062
       TNX L187+0071,2,0           EXIT IF NO SECOND LEVEL TABLE        01870063
       SXD L187+0073,1                                                  01870064
       PDX 0,1                                                          01870065
       TSX L187+0074,4             GO TO SUBROUTINE                     01870066
       LXD L187+0073,1             RESTORE IR1                          01870067
       CAL 0,2               BRING IN FIRST CW OF FIRST                 01870068
       ADD L183+73            ENTRY OF SECOND LEVEL TABLE               01870069
       ALS 18                CHANGE DECR PORTION OF SECOND CW           01870070
       STD 1,1                OF FIRST LEVEL TABLE ENTRY.               01870071
       CLA 1,1                                                          01870072
       PAX 0,1                                                          01870073
       TNX L187+0086,1,0           EXIT IF LAST ENTRY                   01870074
       TXI L187+0059,0,*           GO TO NEXT ENTRY IN FIRST LEVEL TABLE01870075
       SXD L187+0083,4             SUBROUTINE TO CHANGE ADDRESS         01870076
       CLA 1,1                PORTION OF SECOND CONTROL WORD            01870077
       PAX 0,4                                                          01870078
       TNX L187+0084,4,0           EXIT IF LAST ENTRY                   01870079
       CAL 0,4                                                          01870080
       ADD L183+73           ADD TWO                                    01870081
       STA 1,1                                                          01870082
       PXD 0,4                                                          01870083
       PDX 0,1                                                          01870084
       TXI L187+0075,0,*                                                01870085
       LXD L187+0083,4                                                  01870086
       TRA 1,4                                                          01870087
       LXD L187+0051,1                                                  01870088
       TSX L187+0074,4             GO TO SUBROUTINE                     01870089
       LXD L187+0051,1                                                  01870090
       CAL 0,1                                                          01870091
       ADD L183+73           ADD TWO                                    01870092
       STA *                 CHANGE ADDRESS PORTION OF ALPHA ENTRY      01870093
       TRA L187+0045         SWITCH EQU A IF TRA N8, EQU B IF NOP.      01870094
       CLA L184              THIS IS WHERE WE MOVE THE DATA             01870095
       PAX 0,2               ADDRESS WHERE DATA IS LOCATED IN IR2       01870096
       PDX 0,1                                                          01870097
       TXI L187+0097,1,2           INCREASE WORD COUNT BY 2             01870098
       CAL 0,2               BRING IN FIRST CW OF FIRST ENTRY           01870099
       ADD L183+75           ADD TWO IN DECR                            01870100
       PDX 0,4               PLACE WC+7 IN IR4. USE AT N27              01870101
       STD L187+0128                                                    01870102
       COM                                                              01870103
       ADD L183+74           ADD ONE IN DECR                            01870104
       STD L187+0127                                                    01870105
       CLA 1,2                                                          01870106
       CLA 1,2                                                          01870106
       TMI L187+0127         EXIT IF THIS IS A HOLE                     01870107
       CAL 0,2               TEST IF DATA IS TO BE MOVED                01870108
       ADD L183+73           ADD TWO                                    01870109
       ALS 18                                                           01870110
       STO L187+0154                                                    01870111
       PXD 0,2                                                          01870112
       SUB L187+0154                                                    01870113
       TZE L187+0127         EXIT IF DATA IS NOT TO BE MOVED            01870114
       ARS 18                MOVE DIFF OF ADDRESSES INTO ADDR           01870115
       STA L187+0124                                                    01870116
       CLA L187+0154         CONTAINS TWO,S COMP OF WHERE DATA          01870117
       COM                    IS GOING                                  01870118
       ADD L183+74           ADD ONE TO DECR                            01870119
       ANA L183+76                                                      01870120
       ADD L187+0128         ADD WC+2 TO DECR                           01870121
       ARS 18                                                           01870122
       STA L187+0125                                                    01870123
       ADD L187+0124                                                    01870124
       STA L187+0124                                                    01870125
       CLA *,4               MOVE THE RUDDY DATA                        01870126
       STO *,4                                                          01870127
       TIX L187+0124,4,1                                                01870128
       TXI L187+0128,2,*           DECR PRESET IN N24 TO -(WC+2)        01870129
       TIX L187+0097,1,*           DECR PRESET IN N24 TO WC+2           01870130
       CLA L187+0125                                                    01870131
       ANA L183+77           MASK ADDRESS                               01870132
       TZE L187+0136         EXIT IF NO DATA MOVED                      01870133
       COM                                                              01870134
       ADD L183+72           ADD ONE                                    01870135
       PAX 0,2                                                          01870136
       TRA L187+0143         GO TO EXIT                                 01870137
       LXD L187+0154,2                                                  01870138
       CLA 0,2                                                          01870139
       ADD L183+75           ADD TWO TO DEC-                            01870140
       STD L187+0140                                                    01870141
       TIX L187+0141,2,*                                                01870142
       PXD 0,2                                                          01870143
       ARS 18                                                           01870144
       STA L184+1            SET UP ADDRESS OF ALPHA PLUS ONE           01870145
       STZ 0,2               SET UP CODE WORDS                          01870146
       STZ 1,2                AND                                       01870147
       SUB L183+73             EXIT                                     01870148
       STA 0,2                  EXIT                                    01870149
       CLA L184+1                EXIT                                   01870150
       STD 0,2                    EXIT                                  01870151
       CAL L187+0127               EXIT                                 01870152
       STP 1,2                      EXIT                                01870153
       TRA L187+0012                 EXIT                               01870154
       PZE 0,0,*             SAVE FOR RETURN                            01870155
       PZE 0,0,*             NUMBER OF WORDS IN ENTRY +2. TEMP          01870156
       PZE *,0,*                                                        01870157
       TRA L187+0045                                                    01870158
       NOP                                                              01870159
