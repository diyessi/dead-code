       REL                                                              SIN2 001
       ORG 0                                                            SIN2 002
IBSIN2 REM 0112                                                         SIN2 003
       REM IBSIN2 112CARDS SINE AND COSINE FIXED POINT SUBROUTINE       SIN2 004
       REM COMPUTES SINE OR COSINE, CALLING SEQUENCE.....A...TSX SIN,4  SIN2 005
       REM A+1...INPUT SCALE, A+2...HTR 0 OR 1 FOR SIN OR COS, A+3...   SIN2 006
       REM ERROR RETURN, A+4...NORMAL RETURN, ERROR LESS THAN 2 UNITS   SIN2 007
       REM IN TENTH DIGIT. TIMING FROM 2.19 TO 2.73 MS, OUTPUT SCALE 0  SIN2 008
       REM OR EQUAL TO INPUT SCALE IF INPUT SCALE NEGATIVE AND SIN COMP.SIN2 009
   SIN SXD SAVE,1            SAVE XR 1                                  SIN2 010
       STO SIGN              SAVE FRACTION AND SIGN                     SIN2 011
       CLA 1,4               INPUT SCALE BIN1                           SIN2 012
       ADD THFVE             35 + BIN1                                  SIN2 013
       TMI LOW               RETURN WITH ARGUMENT OR 1                  SIN2 014
       PAX 0,1                                                          SIN2 015
       TXH ERR,1,70          ERROR RETURN IF BIN1 LARGER THAN 35        SIN2 016
       LDQ THFVE             SET MQ (ALMOST TO ZERO)                    SIN2 017
       CAL SIGN                                                         SIN2 018
       ALS 2                 AC POSITIVE                                SIN2 019
       TXL SPEC,1,34         BIN1 SMALLER 0, ANGLE SMALLER 1/2 RAD.     SIN2 020
 LRTSH LRS 73,1              B36, REDUCE TO FIRST QUADRANT              SIN2 021
       DVH PIHLF             REDUCED ANGLE IN AC, B1                    SIN2 022
       SUB PIQU              REDUCE TO FIRST QUADRANT                   SIN2 023
       TPL EQUA              COMPUTE EQUIVALENT ANGLE                   SIN2 024
       ADD PIHLF                                                        SIN2 025
  EQUA SUB PIQU              EQUIVALENT ANGLE, SIGN OF AC. NEGATIVE     SIN2 026
       ALS 1                 B0                                         SIN2 027
       SLW REDA              STORE REDUCED ANGLE                        SIN2 028
       LRS 0                 SIGN TO MQ                                 SIN2 029
       CLA 2,4                                                          SIN2 030
   TRA TZE TRA+2                                                        SIN2 031
       STZ SIGN                                                         SIN2 032
       STQ SOR               TEST LAST TWO BITS FOR QUADRANT            SIN2 033
       ACL SOR               00...SIN, 01...COS, 10...-SIN, 11...-COS   SIN2 034
       LXA COMCA+2,1         1 TO XR 1                                  SIN2 035
       TQP A                                                            SIN2 036
     B LBT                                                              SIN2 037
       TRA A+2               COS                                        SIN2 038
       TXI A+2,1,-1          USE SINE FORMULA                           SIN2 039
     A LBT                                                              SIN2 040
       TXI A+2,1,-1                                                     SIN2 041
       ARS 1                 TEST NEXT BIT                              SIN2 042
       LBT                   WHICH DETERMINES SIGN                      SIN2 043
       TRA COMCA             CALCULATE CONTINUED FRACTION               SIN2 044
       CLS SIGN              CHANGE THE SIGN                            SIN2 045
       STO SIGN                                                         SIN2 046
 COMCA LDQ Z                 B0, XR1...0 GIVES SIN, XR...1 GIVES COS    SIN2 047
       MPY Z                                                            SIN2 048
       LRS 1                 B1 FOR SIN,  B1 FOR COS                    SIN2 049
       STO ZSQ                                                          SIN2 050
       ADD CONST+1,1         .8527B1,   .393 B1                         SIN2 051
       STO SOR                                                          SIN2 052
       CLA CONST+3,1         2111.4B13,   4228.3B15                     SIN2 053
       DVH SOR               B 12  , B 14                               SIN2 054
       STQ SOR                                                          SIN2 055
       CLA ZSQ               B1,   B1                                   SIN2 056
       LRS 11                B12,   B12                                 SIN2 057
       TXL C,1,0                                                        SIN2 058
       LRS 2                 B12,   B14                                 SIN2 059
     C ADD CONST+5,1         70.85.B12  ,  105.94.B14                   SIN2 060
       ADD SOR               B12  ,  B14                                SIN2 061
       STO SOR                                                          SIN2 062
       LDQ ZSQ               B1,   B1                                   SIN2 063
       MPR VAR9F+1,1         6B11...6ZSQB12,   338B14...338ZSQ B15      SIN2 064
       ADD CONST+7,1         -377.7B12  ,  6334.0B15                    SIN2 065
       DVH SOR               B0  ,  B1                                  SIN2 066
       STQ SOR                                                          SIN2 067
       CLA SOR                                                          SIN2 068
       SUB ZSQ+1,1           +.1483B0,   -ZSQ B1                        SIN2 069
       ADD CONST+9,1         .9999 B0, .41656 B1                        SIN2 070
       REM                   SIN/Z  OR  COS Z READY IN AC, B0 OR B1     SIN2 071
 TSOUT TXL SOUT,1,0          COMPUTE SINE                               SIN2 072
       SUB ZSQ               SECOND ZSQ                                 SIN2 073
       LDQ SIGN              FIX SIGN                                   SIN2 074
       LLS 2,1               0 FOR SIN, 1 FOR COS                       SIN2 075
       LXD SAVE,1                                                       SIN2 076
  FINI TRA 4,4                                                          SIN2 077
  SOUT STO SOR               COMPUTE SINE                               SIN2 078
       LDQ Z                                                            SIN2 079
       TQP SOUT+4            SCALE OF PRODUCT WILL BE B0                SIN2 080
       LDQ SIGN              SINE EVALUATED WITH GIVEN                  SIN2 081
       MPR SOR               FRACTION FOR GREATER SIGNIFICANCE          SIN2 082
       TXI TSOUT+2,1,2       2 TO XR1                                   SIN2 083
  SPEC LRS 37,1              B0                                         SIN2 084
       SSM                   TO INDICATE PASSAGE THROUGH SPECIAL        SIN2 085
       STO REDA                                                         SIN2 086
       CLA 2,4               0...SIN,  1...COS                          SIN2 087
       PAX 0,1                                                          SIN2 088
       TXL COMCA,1,0                                                    SIN2 089
       STZ SIGN              SET SIGN POSITIVE FOR COMCA                SIN2 090
  SAVE TXL COMCA,0,**                                                   SIN2 091
   LOW CLA 2,4               SIN SET EQU TO ARG                         SIN2 092
       PAX 0,1               COS RETURN WITH ONE                        SIN2 093
       CLA SIGN,1            ARG FOR SINE, 1- EPSILON FOR COS           SIN2 094
       TRA FINI-1                                                       SIN2 095
   ERR TXI FINI-1,4,1        ERROR - RETURN                             SIN2 096
       REM                   CONSTANTS                                  SIN2 097
 THFVE DEC 35                                                           SIN2 098
 PIHLF DEC 1.5707963268B1                                               SIN2 099
  PIQU DEC .78539816340B1                                               SIN2 100
 CONST DEC .393311849248B1,.8527133685845B1,4228.3056424B15             SIN2 101
       DEC 2111.487369067B13,105.940682526B14,70.8525969147B12          SIN2 102
       DEC 6334.05984123B15,-377.73442096B12,.4165629210B1              SIN2 103
       OCT 377777777777                                                 SIN2 104
  SIGN                                                                  SIN2 105
   ZSQ OCT 0,445756247060                                               SIN2 106
 VAR9F DEC 338B14,6B11                                                  SIN2 107
       REM                   COMMON STORAGE                             SIN2 108
 REDA  PZE                                                              SIN2 109
 SOR   PZE                                                              SIN2 110
     Z SYN REDA                                                         SIN2 111
       END 0                                                            SIN2 112
