CA054  REM 0149 11158                                                   CA540001
      DIMENSION A(40,40),B(40),C(40),D(40,40),V(40),DX(40),X(40,40),U(40CA540002
     1),GM(40),L4(40),AX(40),XTB(40),UBX(40),DIF(40)                    CA540003
   10 READ 20                                                           CA540004
   20 FORMAT(55H                                                       )CA540005
      READ30,N,M,M1,E,ND,IBUG,IBUG1                                     CA540006
   30 FORMAT(3I3,E4.1,3I1)                                              CA540007
   35 DO 40 I=1,N                                                       CA540008
   40 READ 50,(A(I,J),J=1,I)                                            CA540009
      READ 50,(B(I),I=1,N)                                              CA540010
   50 FORMAT(7E10.5)                                                    CA540011
      N1=N-1                                                            CA540012
      DO 55 I=1,N1                                                      CA540013
      I1=I+1                                                            CA540014
      DO 55 J=I1,N                                                      CA540015
   55 A(I,J)=A(J,I)                                                     CA540016
      PRINT 60                                                          CA540017
   60 FORMAT(34H1EIGENVALUE'EIGENVECTOR SUBROUTINE)                     CA540018
      PRINT 20                                                          CA540019
      PRINT 70,N,M,M1,E,ND,IBUG,IBUG1                                   CA540020
   70 FORMAT( 3H0N=I2, 4H  M=I2, 5H  M1=I2, 4H  E=E7.1, 5H  ND=I1, 8H  DCA540021
     1EBUG=I1, 9H  DEBUG1=I1/10H0 A MATRIX)                             CA540022
      DO 80 I=1,N                                                       CA540023
   80 PRINT 90,I,(A(I,J),J=1,N)                                         CA540024
   90 FORMAT(4H0ROWI3/(1H 8E14.5))                                      CA540025
      PRINT100,(B(I),I=1,N)                                             CA540026
  100 FORMAT(19H0 B DIAGONAL MATRIX/(1H 8E14.5))                        CA540027
      ND=ND+1                                                           CA540028
      IBUG=IBUG+1                                                       CA540029
      IBUG1=IBUG1+1                                                     CA540030
      DO 200 I=1,N                                                      CA540031
  200 C(I)=1./B(I)                                                      CA540032
      DO 210 I=1,N                                                      CA540033
      DO 210 J=1,N                                                      CA540034
  210 D(I,J)=C(I)*A(I,J)                                                CA540035
      L=1                                                               CA540036
      L2=1                                                              CA540037
  220 DO 725 K=1,M                                                      CA540038
      L4(L)=0                                                           CA540039
      DO 230 I=1,N                                                      CA540040
  230 X(I,L)=1.                                                         CA540041
  240 MAX=0                                                             CA540042
  250 DO 260 I=1,N                                                      CA540043
      DX(I)=0.                                                          CA540044
      DO 260 J=1,N                                                      CA540045
  260 DX(I)=DX(I)+D(I,J)*X(J,L)                                         CA540046
      XX=0.                                                             CA540047
      XTDX=0.                                                           CA540048
      DO 270 I=1,N                                                      CA540049
      XX=XX+X(I,L)**2                                                   CA540050
  270 XTDX=XTDX+X(I,L)*DX(I)                                            CA540051
      U(L)=XTDX/XX                                                      CA540052
      DO 280 I=1,N                                                      CA540053
  280 V(I)=DX(I)-U(L)*X(I,L)                                            CA540054
      DO 300 I=1,N                                                      CA540055
      IF(DX(I))290,285,290                                              CA540056
  285 DX(I)=V(I)/E                                                      CA540057
  290 IF(ABSF(V(I))-E*ABSF(DX(I)))300,300,310                           CA540058
  300 CONTINUE                                                          CA540059
      ASSIGN 405 TO BD                                                  CA540060
      GO TO 352                                                         CA540061
  310 MAX=MAX+1                                                         CA540062
      IF(MAX-150)320,360,360                                            CA540063
  320 DO 330 I=1,N                                                      CA540064
      DX(I)=0.                                                          CA540065
      DO 330 J=1,N                                                      CA540066
  330 DX(I)=DX(I)+D(I,J)*V(J)                                           CA540067
      XX=0.                                                             CA540068
      XTDX=0.                                                           CA540069
      DO 340 I=1,N                                                      CA540070
      XX=XX+V(I)**2                                                     CA540071
  340 XTDX=XTDX+V(I)*DX(I)                                              CA540072
      Z=XTDX/XX                                                         CA540073
      DO 350 I=1,N                                                      CA540074
  350 X(I,L)=X(I,L)+(.8/ABSF(U(L)-Z))*V(I)                              CA540075
      ASSIGN 250 TO BD                                                  CA540076
  352 GO TO (358,354),IBUG1                                             CA540077
  354 PRINT 356,L,MAX,XX,XTDX,U(L),Z,(DX(I),V(I),X(I,L),I=1,N)          CA540078
  356 FORMAT(14H0DEBUG1 OUTPUT/1H 2I4,1P4E14.4/(1H 1P3E14.4))           CA540079
  358 GO TO BD,(405,250,490)                                            CA540080
  360 DO 380 I=1,N                                                      CA540081
      IF(DX(I))375,370,375                                              CA540082
  370 DX(I)=V(I)/(999.99*E)                                             CA540083
  375 IF(ABSF(V(I))-1000.*E*ABSF(DX(I)))380,380,400                     CA540084
  380 CONTINUE                                                          CA540085
      L4(L)=L4(L)+1                                                     CA540086
      ASSIGN 405 TO BD                                                  CA540087
      GO TO 352                                                         CA540088
  400 L4(L)=L4(L)+2                                                     CA540089
      ASSIGN 490 TO BD                                                  CA540090
      GO TO 352                                                         CA540091
  405 IF(M1)440,440,410                                                 CA540092
  410 IF(X(M1,L))420,440,420                                            CA540093
  420 XNML=X(M1,L)                                                      CA540094
      DO 430 I=1,N                                                      CA540095
  430 X(I,L)=X(I,L)/XNML                                                CA540096
  440 DO 450 I=1,N                                                      CA540097
  450 XTB(I)=X(I,L)*B(I)                                                CA540098
      GM(L)=0.                                                          CA540099
      DO 460 I=1,N                                                      CA540100
  460 GM(L)=GM(L)+XTB(I)*X(I,L)                                         CA540101
      CN=U(L)/GM(L)                                                     CA540102
      DO 470 J=1,N                                                      CA540103
      DO 470 I=1,N                                                      CA540104
  470 D(I,J)=D(I,J)-CN*X(I,L)*XTB(J)                                    CA540105
      IF(L-M)475,490,730                                                CA540106
  475 IF(L-7-L2)640,490,640                                             CA540107
  490 PRINT 60                                                          CA540108
      PRINT 20                                                          CA540109
      PRINT 500,(U(L1),L1=L2,L)                                         CA540110
  500 FORMAT(6H0EGVAL,1P8E13.4)                                         CA540111
      PRINT 540,(L1,L1=L2,L)                                            CA540112
  540 FORMAT(6H0EGVEC,I8,7I13)                                          CA540113
      DO 550 I=1,N                                                      CA540114
  550 PRINT 560,I,(X(I,L1),L1=L2,L)                                     CA540115
  560 FORMAT(3H0  ,I2,1PE14.4,1P7E13.4)                                 CA540116
      DO 630 L1=L2,L                                                    CA540117
      IF(L4(L1)-1)630,610,570                                           CA540118
  570 PRINT 600,L1                                                      CA540119
  600 FORMAT(22H0BAD ACCURACY ON EGVALI3)                               CA540120
      GO TO 730                                                         CA540121
  610 PRINT 620,L1                                                      CA540122
  620 FORMAT(31H0ACCURACY REDUCED BY 3 ON EGVALI3)                      CA540123
  630 CONTINUE                                                          CA540124
      L2=L2+8                                                           CA540125
  640 GO TO (720,650),IBUG                                              CA540126
  650 DO 660 I=1,N                                                      CA540127
      AX(I)=0.                                                          CA540128
      DO 660 J=1,N                                                      CA540129
  660 AX(I)=AX(I)+A(I,J)*X(J,L)                                         CA540130
      DO 680 I=1,N                                                      CA540131
  670 UBX(I)=U(L)*B(I)*X(I,L)                                           CA540132
  680 DIF (I)=AX(I)-UBX(I)                                              CA540133
      PRINT 690,L,L4(L),U(L),GM(L),(X(I,L),XTB(I),AX(I),UBX(I),DIF(I),I=CA540134
     11,N)                                                              CA540135
  690 FORMAT(13H0DEBUG OUTPUT/1H 2I3,1P2E14.4/(1H 1P5E14.4))            CA540136
      PRINT 700                                                         CA540137
  700 FORMAT(16H DEFLATED MATRIX)                                       CA540138
      DO 710 I=1,N                                                      CA540139
  710 PRINT 760,I,(D(I,J),J=1,N)                                        CA540140
  720 L=L+1                                                             CA540141
  725 CONTINUE                                                          CA540142
  730 PRINT 740                                                         CA540143
  740 FORMAT(17H1 DEFLATED MATRIX)                                      CA540144
      DO 750 I=1,N                                                      CA540145
  750 PRINT 760,I,(D(I,J),J=1,N)                                        CA540146
  760 FORMAT(4H0ROWI3/(1H 8E14.5))                                      CA540147
      GO TO(770,10,35),ND                                               CA540148
  770 STOP                                                              CA540149
J3 CE 9CAP          0567         SY                                             
CE9CAP REM 075  12098                                                   CE9CAP01
       REM REVISED GMCAP1 PROGRAM                                       CE9CAP03
       REM CE9CAP  COMMENT ATTACHED PRINTER 709                         CE9CAP02
 9CAP  SXA 9C66,1            SAVE IR1                                   CE9CAP04
       SXA 9C67,2            IR2                                        CE9CAP05
       SXA 9C68,4            IR4                                        CE9CAP06
       CLA 1,4               GET CONTROL WORD                           CE9CAP07
       PDX 0,2               N TO IR2                                   CE9CAP08
 9C05  SXA 9C63,2            SAVE N                                     CE9CAP09
       ADD 9C11              L PLUS 10                                  CE9CAP10
       STA 9C17              SET TERMINUS                               CE9CAP11
       CLA 9C59              INITIALIZE                                 CE9CAP12
       STA 9C47              IMAGE ORIGIN                               CE9CAP13
       WPDA                  SELECT PRINTER                             CE9CAP14
 9C11  AXT 10,4                                                         CE9CAP15
 9C12  AXT 12,1                                                         CE9CAP16
 9C13  STZ COMMON+24,1       CLEAR IMAGE                                CE9CAP17
       TIX 9C13,1,1                                                     CE9CAP18
       CLA     9C74                                                     CE9CAP19
       STO COMMON+24                                                    CE9CAP20
 9C17  LDQ **,4              GET BCD WORD                               CE9CAP21
 9C18  CLM                                                              CE9CAP22
       LGL 2                                                            CE9CAP23
       PAX 0,2               ZONE BITS TO IR2                           CE9CAP24
       CLM                                                              CE9CAP25
       LGL 4                                                            CE9CAP26
       PAX 0,1               NUMERIC BITS TO IR1                        CE9CAP27
       TXL 9C28,2,0          TRA IF ZONES =0                            CE9CAP28
       CAL COMMON+24                                                    CE9CAP29
       TXL 9C33,1,0          TRA IF NUMERIC =0                          CE9CAP30
       ORS COMMON+24,2       INSERT ZONE BITS                           CE9CAP31
 9C28  TXL 9C38,1,9          TRA IF NUMERIC 9 OR LES                    CE9CAP32
       TXH 9C36,1,10         TRA IF NUMERIC 11 OR MORE                  CE9CAP33
       TXH 9C36,2,2          TRA IF ZONE=3                              CE9CAP34
       ORS COMMON+21         BIT TO ZERO ROW                            CE9CAP35
       TRA 9C39                                                         CE9CAP36
 9C33  TXH 9C39,2,2          TRA IF ZONES 2 OR MORE                     CE9CAP37
       ORS COMMON+24,2       INSERT 12 ROW                              CE9CAP38
       TRA 9C39                                                         CE9CAP39
 9C36  ORS COMMON+13         BIT TO 8 ROW                               CE9CAP40
       TXI 9C38,1,-8         IR1 MINUS 8                                CE9CAP41
 9C38  ORS COMMON+21,1       STROBE BIT TO NUM ROW                      CE9CAP42
 9C39  ARS 1                 MOVE STROBE                                CE9CAP43
       SLW COMMON+24                                                    CE9CAP44
       TZE 9C45              TRA IF 1/2 IMAGE STORED                    CE9CAP45
       ANA 9C73              ACC TO 0 EVERY 6TH TIME                    CE9CAP46
       TNZ 9C18              GET NEXT LETTER                            CE9CAP47
       TIX 9C17,4,1          GET NEXT WORD                              CE9CAP48
 9C45  AXT 12,1                                                         CE9CAP49
 9C46  CLA COMMON+24,1       MOVE IMAGE                                 CE9CAP50
 9C47  STO **,1                                                         CE9CAP51
       TIX 9C46,1,1                                                     CE9CAP52
       CAL 9C47              MOVE IMAGE ORIGIN                          CE9CAP53
       ADD 9C12              BY 12 FOR RT IMAGE                         CE9CAP54
       STA 9C47                                                         CE9CAP55
       TIX 9C12,4,1          BACK FOR OTHER 1/2                         CE9CAP56
       RCHA 9C72             9L TO DSC                                  CE9CAP57
       AXT 12,1                                                         CE9CAP58
 9C55  CLA COMMON+24,1                                                  CE9CAP59
       STO COMMON            R TO COMMON                                CE9CAP60
       LCHA 9C72             L TO PRINTER,R TO DSC                      CE9CAP61
       TNX 9C63,1,1          TRA IF 12R TO DSC                          CE9CAP62
 9C59  CLA COMMON+12,1                                                  CE9CAP63
       STO COMMON            L TO COMMON                                CE9CAP64
       LCHA 9C72             R TO PRINTER,L TO DSC                      CE9CAP65
       TRA 9C55                                                         CE9CAP66
 9C63  AXT **,2              N TO IR 2                                  CE9CAP67
       CLA 9C17              BCD WORD ORIGIN                            CE9CAP68
       TIX 9C05,2,10         BACK FOR NEXT LINE                         CE9CAP69
 9C66  AXT **,1              RESTORE IR1                                CE9CAP70
 9C67  AXT **,2              IR2                                        CE9CAP71
 9C68  AXT **,4              IR4                                        CE9CAP72
       WPDA                                                             CE9CAP73
       SPRA 2                EJECT PAGE                                 CE9CAP74
       TRA 2,4               RETURN                                     CE9CAP75
 9C72  IOCT COMMON,0,1                                                  CE9CAP76
 9C73  TXH 30687,3,30687     MASK                                       CE9CAP77
9C74   MZE                                                              CE9CAP78
