   NA 07.10FIXED INPUT OUTPUT SCALING SUBROUTINE                     051NUDEK06L
       ORG   NA 007  FIXED SCALING                                      07.10001
    P0 DCT                     TURN OFF DIVIDE CK INDICATOR             07.10002
   P21 TXI P22                                                          07.10003
   P22 SXD P21,1               SAVE CONTENTS OF IRA                     07.10004
       STO T                   STORE ARGUMENT                           07.10005
       CLA 1,4                 DECIMAL SCALE                            07.10006
       STO T+5                                                          07.10007
       LDQ 2,4                 BINARY SCALE                             07.10008
       STQ T+2                                                          07.10009
   P19 CLA D                   33                                       07.10010
       TQP P1                  ALTER MAX SHIFT                          07.10011
    P2 STO T+1                 MAXIMUM SHIFT                            07.10012
    P8 LLS 0                   WITH SIGN OF B                           07.10013
       TPL P3                                                           07.10014
       TLQ P4                  MAX SHIFT IS WORKING B                   07.10015
    P5 LLS 35                  B IS WORKING B                           07.10016
    P4 STO T+3                                                          07.10017
       TMI P6                  AVOID SHIFT ALTERATION                   07.10018
       ADD D+1                 ALTER SHIFT                              07.10019
    P6 SSP                     POSITIVE INSTRUCTION                     07.10020
       ADD P8                  LLS 0                                    07.10021
       STO P9                  STORE SHIFT COMMANDS                     07.10022
       STO P10                 X                                        07.10023
       CLA T+5                 DECIMAL SCALE                            07.10024
       LDQ TA-1                     TEN IN MQ                           07.10025
       LRS 0                   WITH SIGN OF D                           07.10026
       TLQ P11                                                          07.10027
       TMI P13                                                          07.10028
   P12 STO T+4                 WORKING D                                07.10029
   P14 LXA T+4,1               D IN IRA                                 07.10030
       LDQ T                   ARGUMENT IN MQ                           07.10031
       TMI P15                 TO NEGATIVE SCALING                      07.10032
       MPY TA,1                MPY BY POWER OF TEN                      07.10033
    P9 NOP                     SHIFT                                    07.10034
       TZE P16                 COMPATIBLE MAGNITUDES                    07.10035
   P17 LXD P21,1               RESET IRA                                07.10036
       TRA 3,4                 ERROR EXIT                               07.10037
   P15 CLM                     NEGATIVE SCALING                         07.10038
       LLS 0                   SIGN OF ARGUMENT IN ACC                  07.10039
   P10 NOP                     SHIFT                                    07.10040
       DVP TA,1                DIV BY POWER OF TEN                      07.10041
       DCT                                                              07.10042
       TRA P17                 TO ERROR EXIT                            07.10043
   P16 CLA T+5                 D MINUS                                  07.10044
       SUB T+4                 WORKING D                                07.10045
       STO T+5                 REPLACES D                               07.10046
       CLA T+2                 B MINUS                                  07.10047
       SUB T+3                 WORKING B                                07.10048
       STO T+2                 REPLACES B                               07.10049
       STQ T                   RESULT REPLACES ARGUMENT                 07.10050
       TZE P18                 TEST NEW B                               07.10051
   P20 LDQ T+2                                                          07.10052
       TRA P19                 REPEAT SCALING LOOP                      07.10053
   P18 CLA T+5                 TEST NEW D                               07.10054
       TNZ P20                                                          07.10055
       CLA T                   SCALED NUMBER                            07.10056
       LXD P21,1               RESTORE IRA                              07.10057
       TRA 4,4                 SUCCESSFUL EXIT                          07.10058
    P1 ADD TA                  ONE                                      07.10059
       TRA P2                                                           07.10060
    P3 TLQ P5                                                           07.10061
       TRA P4                                                           07.10062
   P11 TMI P12                                                          07.10063
   P13 STQ T+4                                                          07.10064
       TRA P14                                                          07.10065
     D DEC 33                                                           07.10066
       OCT 000200000000                                                 07.10067
       DEC 10000000000,1000000000,100000000                             07.10068
       DEC 10000000,1000000,100000,10000,1000,100,10                    07.10069
    TA DEC 1                                                            07.10070
     T BSS 6                   6 TEMPORARY WORDS                        07.10071
       END                                                              07.10072
