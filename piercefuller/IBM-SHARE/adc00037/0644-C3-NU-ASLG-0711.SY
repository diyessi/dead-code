C     CALCULATION OF ASSOCIATED LEGENDRE FUNCTIONS HALF INTEGRAL ORDER  NUASLG01
      SUBROUTINE ASLG(X,M,P,Q,DP,DQ)                                    ASLG 002
      DIMENSION P(21),Q(21),DP(20),DQ(20)                               ASLG 003
      SENSE LIGHT 0                                                     ASLG 004
  300 IF (M) 400,401,401                                                ASLG 005
  401 IF(M-21)402,402,400                                               ASLG 006
  402 EM=M                                                              ASLG 007
      IF (X-1.000098) 410,410,403                                       ASLG 008
  403 A=EM*0.07277                                                      ASLG 009
      EX = 39.5/10.0**A +4.0                                            ASLG 010
      IF (X-EX) 404,404,410                                             ASLG 011
  404 IF (X-1.05) 405,1,1                                               ASLG 012
  405  A=  0.24375 * ( 21.0 - M)                                        ASLG 013
      EX= 0.05 / 10.0 **A + 1.00                                        ASLG 014
      IF (EX-X) 1,410,410                                               ASLG 015
  400 PRINT 4001                                                        ASLG 016
      STOP70                                                            ASLG 017
 4001 FORMAT(15H M OUT OF RANGE)                                        ASLG 018
 410  PRINT4002                                                         ASLG 019
      PAUSE71                                                           ASLG 020
 4002 FORMAT(55H X OUT OF RANGE. PUSH START TO PROCEED AT YOUR OWN RISK)ASLG 021
   1  TANK=1.0                                                          ASLG 022
      COTK=1.0/SQRTF(X)                                                 ASLG 023
      EX=X**2-1.0                                                       ASLG 024
      EXE=(X-1.0)/(X+1.0)                                               ASLG 025
      EXX=X**2/EX                                                       ASLG 026
      EMFACT=1.0                                                        ASLG 027
      GAMA=1.0                                                          ASLG 028
      GAMB=1.0                                                          ASLG 029
   2   IF  (M-1) 8,5,3                                                  ASLG 030
 3    DO4I=2,M                                                          ASLG 031
      EMM=I                                                             ASLG 032
  4   EMFACT=EMM*EMFACT                                                 ASLG 033
 5    L=2*M                                                             ASLG 034
      DO6I=1,L                                                          ASLG 035
      ELL=M-I                                                           ASLG 036
      GAMA=(.50+ELL)*GAMA                                               ASLG 037
 6    GAMB=(1.50+ELL)*GAMB                                              ASLG 038
      A=EM/2.0                                                          ASLG 039
 7    TANK=EXE**A                                                       ASLG 040
      COTK=(EXX**A)*COTK                                                ASLG 041
   8  IF ACCUMULATOR OVERFLOW 9,9                                       ASLG 042
   9  IF QUOTIENT OVERFLOW 10,10                                        ASLG 043
  10  P(1)=GAMA*TANK*HYGEOM(.50,.50+EM,EM+1.0,EXE)/(SQRTF((X+1.0)/2.0)* ASLG 044
     XEMFACT)                                                           ASLG 045
 101  P(2)=GAMB*TANK*HYGEOM(-.50,-.50+EM,EM+1.0,EXE)                    ASLG 046
     X*SQRTF((X+1.0)/2.0)/EMFACT                                        ASLG 047
 11   EN=1.5                                                            ASLG 048
      DO13I=3,21                                                        ASLG 049
      P(I)=(2.0*EN-1.0)*X*P(I-1)-(EN+EM-1.0)*P(I-2)                     ASLG 050
      IF ACCUMULATOR OVERFLOW 205,12                                    ASLG 051
 12   P(I)=P(I)/(EN-EM)                                                 ASLG 052
      IF QUOTIENT OVERFLOW 205,13                                       ASLG 053
 13   EN=EN+1.0                                                         ASLG 054
 14   N=22                                                              ASLG 055
      EN=41.5                                                           ASLG 056
 16   QQQQ=0.0                                                          ASLG 057
      QQQ=1.0E-29                                                       ASLG 058
      DO19I=1,N                                                         ASLG 059
      QQ=(2.0*EN-1.0)*X*QQQ-(EN-EM)*QQQQ                                ASLG 060
      IF ACCUMULATOR OVERFLOW 2081,17                                   ASLG 061
 17   QQ=QQ/(EN+EM-1.0)                                                 ASLG 062
      IF QUOTIENT OVERFLOW 2081,18                                      ASLG 063
 18   EN=EN-1.0                                                         ASLG 064
      QQQQ=QQQ                                                          ASLG 065
 19   QQQ=QQ                                                            ASLG 066
      Q(21)=QQQQ                                                        ASLG 067
      Q(20)=QQQ                                                         ASLG 068
      DO21I=1,19                                                        ASLG 069
      J=20-I                                                            ASLG 070
      Q(J)=(2.0*EN-1.0)*Q(J+1)*X-(EN-EM)*Q(J+2)                         ASLG 071
      IF ACCUMULATOR OVERFLOW 209,20                                    ASLG 072
 20   Q(J)=Q(J)/(EN+EM-1.0)                                             ASLG 073
 21   EN=EN-1.0                                                         ASLG 074
 22   GAMA=3.14159265/1.414214                                          ASLG 075
      IF(M)25,25,23                                                     ASLG 076
 23   DO24I=1,M                                                         ASLG 077
      EI=I                                                              ASLG 078
 24   GAMA=(EI-.50)*GAMA                                                ASLG 079
 25   QQ=GAMA*COTK*HYGEOM(.25-EM/2.0,.75-EM/2.0,1.0,1.0/(X**2))         ASLG 080
      IF ACCUMULATOR OVERFLOW 212,26                                    ASLG 081
  26  QQ = QQ/Q(1)                                                      ASLG 082
      DO27I=1,21                                                        ASLG 083
 27   Q(I)=QQ*Q(I)                                                      ASLG 084
 30   DO32I=1,20                                                        ASLG 085
      EI=I                                                              ASLG 086
      EI=EI-0.50                                                        ASLG 087
      S=(EI-EM)/EX                                                      ASLG 088
      T=X*EI/EX                                                         ASLG 089
      DP(I)=S*P(I+1)-T*P(I)                                             ASLG 090
 31   DQ(I)=S*Q(I+1)-T*Q(I)                                             ASLG 091
 32   CONTINUE                                                          ASLG 092
 33   RETURN                                                            ASLG 093
 205  PRINT206,I,X,M                                                    ASLG 094
 206  FORMAT(4H  P(I2,10H) FOR X = F8.2,5H M = I2,21H GREATER THAN 10 E ASLG 095
     X38)                                                               ASLG 096
      DO207J=I,21                                                       ASLG 097
 207  P(J)=1.5E38                                                       ASLG 098
      GOTO14                                                            ASLG 099
 2081 SENSE LIGHT1                                                      ASLG 100
 208  N=4                                                               ASLG 101
      EN=23.5                                                           ASLG 102
      GOTO16                                                            ASLG 103
 209  IF (SENSE LIGHT 1) 212,208                                        ASLG 104
 212  PRINT213,X,M                                                      ASLG 105
      STOP 212                                                          ASLG 106
 213  FORMAT(10H  FOR X = F8.2,4H M =I2,25H Q CALCULATION OVERFLOWS.)   ASLG 107
      END(0,1,0,0,0)                                                    ASLG 108
C     SUBFUNCTION TO EVALUATE THE HYPERGEOMETRIC FUNCTION.              ASLG 109
      FUNCTION HYGEOM(A,B,C,X)                                          ASLG 110
      EX=A*B*X/C                                                        ASLG 111
      HYGEOM=1.0+EX                                                     ASLG 112
      DO1I=1,16380                                                      ASLG 113
      EI=I                                                              ASLG 114
      EX=EX*(A+EI)*(B+EI)*X/((EI+C)*(EI+1.0))                           ASLG 115
      HYGEOM=HYGEOM+EX                                                  ASLG 116
      IF(ABSF(EX)-10.0E-9 )2,1,1                                        ASLG 117
 1    CONTINUE                                                          ASLG 118
 2    RETURN                                                            ASLG 119
      END(0,1,0,1,0)                                                    ASLG 120
